# 5.18 Amazon Bedrock - CloudWatch Integration - Hands On

So let's have a look at the integrationbetween Bedrock and CloudWatch logs.So we're gonna go under settings on the bottom left,and you have model invocation logging.So here we can definitely enable it.And then this is going to collect all metadatarequest and responses for all model invocationsin your accounts.So you can select the type of datayou want to include with logs.So it could be text, images and embeddings.And then the destination could be Amazon S3 buckets,or it could be CloudWatch only, or it could be both.So I'm just going to use CloudWatch only.And then you need to specify a log group name.So I call this one Bedrock Invocation Logging.And then I will create a user new role.So this is the role that Amazon Bedrock will needto send data to CloudWatch log.So I call one BedrockInvocation Logging Role.Okay.And next we have external location for larger delivery.So in case it's over 100 kilobytes,then it can be published to Amazon S3,but we don't need this right now,so we're going to just save these settings.So we get an error saying the specified log groupdoesn't exist, so we have to create it manuallyin CloudWatch in this instance.Maybe this will be fixed by the time you use this.But let's go into CloudWatch logs, log groups,and then you're going to create a new log group.And the name is going to be this onethat I'm going to copy and paste.So we can set up some settings.Do you want the log to expire or not?But we're just going to click on create and get going.Okay, so now my log group is created.It is here.And let's go ahead in Amazon Bedrock.And we're going to save these settings one more time.And we now need to say that we want to usean existing service role, that is right here,so let me refresh this.This is sometimes a bit annoying when you have issueson the console, but AWS may fix this at some point.So here we go.Now we select the existing role that has been createdand save the settings and we should be good to go.Okay, so the settings have been saved successfully.And what I can do now is I can go in chat,I will select a model, and I will just click on run.And then we're going to get, so we send an input,and then we get an output, and we're good to go.Now let's wait a little bit and then go into CloudWatch logsto see if this appears.So I'm going into CloudWatch logs and we refresh this page,and we have one log stream here.It is Bedrock Model Invocations,and here we have the informationthat the permissions are set correctlyfor Amazon Bedrock logs.And then we get some information about a model invocation.So we get a lot of information around it,but we know that, for example,the model ID is Amazon.Titan-Text-Express-V1.This is a way for us to identifythe models that we're using.We get information about the region,and then we get the messages.So we have a user, that's us, and we sent this input,and then we have some information around the configurationfor this invocation.And how many tokens was it? 271.And the output is this message.So the assistant role means that it's the model itself,and the content is this.And so again, we get the informationthat the latency was 4,038 millisecond.We get information around the output token,the total token, and so on.So this is very helpful because as you can see,a lot of information is included here,and we can use this information later onto debug everything.For example, we could, for example, run an alarmand to look at if the latencyis always beneath a specific number.And if one day the latency reaches a high number,then we may want to send an alert saying,"Hey, your latency requirements are a little too high now,and the user experience may be degraded."So that's the way of doing it.But hopefully you get the ideaof integrating Amazon Bedrock with CloudWatch Logs.So the other thing we can do is go into CloudWatch,and go into all metrics, and then click on Bedrock.And you may have more metrics than me,but we have here metrics by model ID.You can look at it, or across all model ID.And for example, we can have a look at the numberof invocations or for example, the invocation latency.And we can see here that the latencyis being plotted on this graph.So now of course, if you have a sustained usageof Amazon Bedrock, then you will see a curve herewith multiple data points.But a lot of metrics are being sent by Bedrockinto CloudWatch metrics.And you can then build metrics, graphs, dashboards,and alarms on top of it as well in case, for example,the invocation latency gets too high.So that's it for this lecture, I hope you liked it,and I will see you in the next lecture.